<?xml version="1.0" encoding="utf-8"?>
<qroot>
<question>
<Title>how to create a dictionary of pandas dataframes, and return the dataframes into excel worksheets?</Title>
<Body>&lt;p&gt;how to create a dictionary of pandas dataframes, and return the dataframes into excel worksheets?&lt;/p&gt;&lt;p&gt;Hi All,&lt;/p&gt;&lt;p&gt;I am learning pandas and python, and I want to create a dictionary which contains a some dataframes, which I can then run metrics over each dataframe. With each unique cluster name (one of the columns) I would like to create a dataframe (subset of original dataframe.&lt;/p&gt;&lt;p&gt;Then I would like to be able to select it, run metrics over it, putting the results in a new dataframe, and then place the original dataframe (each subset) into a separate worksheet using xlsxwriter python library.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;#create dictionary object    c_dict = {}#get a list of the unique namesc_dict= data.groupby(&#x27;Cluster&#x27;).groups#create a dictionary of dataframes, one for each clusterfor cluster in c_dict.items():    df = data[data[&#x27;Cluster&#x27;]==cluster    c_dict[cluster] =df                                                        &amp;lt;&amp;lt;&amp;lt; im getting invalid syntax here#go through the dictionary and create a worksheet and put the dataframe in it.for k,v in c_dict.items():    dataframe = GetDF(k)                                                            &amp;lt;&amp;lt;&amp;lt; creating worksheets and puts the data from the dataframe &amp;gt; worksheet is not working because of invalid syntax when trying to create dataframe dictionary ^^    dataframe.to_excel(writer,sheet_name=k)writer.save#get the dataframe from the dictionary,GetDF(dictionary_key)          return c_dict[dictionary_key]&lt;/code&gt;&lt;/pre&gt;</Body>
<Tags>python,dictionary,pandas</Tags>
</question>
<answer>
<Body>&lt;p&gt;I think this is what you&#x27;re looking for.  As I said in the comments, it&#x27;s probably not the right solution and it&#x27;s definitely not idomatic for pandas DataFrames.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;import pandas as pdgroups = data.groupby(&#x27;Cluster&#x27;)#create a dictionary of dataframes, one for each clusterc_dict = {k: pd.DataFrame(v) for k, v in groups.groups.iteritems() }&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If you want to save this to an excel file, the documentation is here: &lt;a href=&quot;http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.to_excel.html&quot; rel=&quot;nofollow&quot;&gt;http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.to_excel.html&lt;/a&gt; &lt;/p&gt;&lt;p&gt;There is a nice example at the bottom that will do what you need.  Hint: use &lt;code&gt;for k,v in myDict.iteritems()&lt;/code&gt; to get keys and values.&lt;/p&gt;</Body>
</answer>
</qroot>
