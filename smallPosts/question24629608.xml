<?xml version="1.0" encoding="utf-8"?>
<qroot>
<question>
<Title>Get files created before x days, y hours and z minutes in python?</Title>
<Body>&lt;p&gt;Hi I have the below program which should give me the list of files created before a given amount of time from the current time&lt;/p&gt;&lt;pre&gt;&lt;code&gt;def filesOlderThan(path,day,hour,mins):    file_list = []    for root, dirs, files in os.walk(path):        for a in files:            path1 = root + &quot;\\&quot;+ a            sub_time = datetime.datetime.today() - datetime.timedelta(days=day,hours=hour,minutes=mins)            r_time = time.mktime(sub_time.utctimetuple())            c_time = os.path.getctime(path1)            if(r_time &amp;lt; c_time):                file_list.append(path1)    count = len(file_list)    return file_list,countfiles,count = filesOlderThan(&quot;C:\\Arena\\sample&quot;,0,0,10)print countfor a in files:    print a&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When I run the program&lt;/p&gt;&lt;pre&gt;&lt;code&gt;C:\Arena&amp;gt;python getFilesOlderThan.py  0&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The program works for values hour values, but does not work with the following input case&lt;/p&gt;&lt;ol&gt;&lt;li&gt;I set the minutes to 10&lt;/li&gt;&lt;li&gt;Create a file inside C:\Arena\Sample&lt;/li&gt;&lt;li&gt;Run the program, the program does not give me the file.&lt;/li&gt;&lt;/ol&gt;</Body>
<Tags>python,datetime,timedelta</Tags>
</question>
<answer>
<Body>&lt;pre&gt;&lt;code&gt;r_time = time.mktime(sub_time.utctimetuple())&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;You&#x27;re comparing the file&#x27;s timestamp in localtime withthe current time in UTC.&lt;/p&gt;&lt;p&gt;You should use &lt;code&gt;timetuple()&lt;/code&gt; instead of &lt;code&gt;utctimetuple&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;You can make some minor improvements to your function, such as doing calculations using &lt;code&gt;datetime&lt;/code&gt;s instead of timestamps, using &lt;code&gt;datetime.now&lt;/code&gt; instead of &lt;code&gt;today&lt;/code&gt; and using cross-platform &lt;code&gt;os.join&lt;/code&gt; instead of hard-coded windows separators. It also seems unnecessary to calculate the &lt;code&gt;len&lt;/code&gt; of the list inside the function - you can do it outside, if it&#x27;s needed.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;def filesOlderThan(path,day,hour,mins):    delta= datetime.timedelta(days=day,hours=hour,minutes=mins)    now= datetime.datetime.now()    file_list = []    for root, dirs, files in os.walk(path):        for a in files:            path1 = os.path.join(root, a)            c_time = datetime.datetime.fromtimestamp(os.path.getctime(path1))            if(now - delta &amp;lt; c_time):                file_list.append(path1)    return file_list&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Finally, if you ever plan on sending these timestamps to another system, remember to convert them to utc (both the file&#x27;s and the current). You&#x27;ll probably want to use &lt;code&gt;pytz&lt;/code&gt; for that.&lt;/p&gt;</Body>
</answer>
</qroot>
