<?xml version="1.0" encoding="utf-8"?>
<qroot>
<question>
<Title>Can/Why Does A Hard Drive Serial Number Change</Title>
<Body>&lt;p&gt;Our anti-piracy software identifies people according to their Hard Drive Serial. This I believe is a constant feature and will not change unless the user changes their primary physical drive - correct me if I am wrong? We use the &lt;code&gt;WMI&lt;/code&gt; python module to obtain the users Hard Drive Serial Number.&lt;/p&gt;&lt;p&gt;For 2 of our test computers the Hard Drive serial number has changed. But we haven&#x27;t changed their hard drive at all. &lt;/p&gt;&lt;p&gt;&lt;strong&gt;What could cause such a problem?&lt;/strong&gt; Is our code that identifies the serial not comprehensive across windows operating systems? I did notice that this &lt;a href=&quot;https://stackoverflow.com/questions/9683278/how-to-get-hard-disk-drivers-serial-number-in-python&quot;&gt;post&lt;/a&gt; mentions you can get the wrong serial if a standard user process retrieves the serial no. But in our case the error has occurred on an admin user aswell.&lt;/p&gt;&lt;p&gt;Some important information:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Both of these test nodes run Windows 8 Professional  &lt;/li&gt;&lt;li&gt;One computer is a Toshiba laptop  &lt;/li&gt;&lt;li&gt;The other computer is an Acer Iconia tablet  &lt;/li&gt;&lt;li&gt;The tablet was recently updated from Windows 8 to Windows 8.1 and I noticed that the serial changed after this update  &lt;/li&gt;&lt;li&gt;The laptop has an admin user who experienced the issue. The tablet has a standard user who experienced the issue.  &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;em&gt;Also is the Hard Drive Serial number the MAC address of the hardware device or something else?&lt;/em&gt;&lt;/p&gt;&lt;p&gt;Code to obtain the Hard Drive Serial number:&lt;/p&gt;&lt;pre&gt;&lt;code&gt;c = wmi.WMI()for item in c.Win32_PhysicalMedia():    if &quot;PHYSICALDRIVE&quot; in str(item.Tag).upper():        serialNo = item.SerialNumber        break&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Edit:&lt;/strong&gt; A short script that retrieves a users Hard Drive Serial number as a normal process and as an elevated/admin process. &lt;/p&gt;&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; For me it outputs exactly the same serial number no matter as a user or as a admin. Does this script do the same for you aswell?&lt;/p&gt;&lt;pre&gt;&lt;code&gt;import osimport sysimport wmiimport win32com.shell.shell as shellASADMIN = &#x27;asadmin&#x27;def get_elevated_privleges():    if sys.argv[-1] != ASADMIN:        script = os.path.abspath(sys.argv[0])        params = &#x27; &#x27;.join([script] + sys.argv[1:] + [ASADMIN])        shell.ShellExecuteEx(lpVerb=&#x27;runas&#x27;, lpFile=sys.executable, lpParameters=params)def get_hard_drive_serial():    c = wmi.WMI()    for item in c.Win32_PhysicalMedia():        if &quot;PHYSICALDRIVE&quot; in str(item.Tag).upper():            return str(item.SerialNumber)    return Noneprint &quot;HD Serial as Regular User: &quot; + get_hard_drive_serial()get_elevated_privleges()print &quot;HD Serial as Admin User: &quot; + get_hard_drive_serial()&lt;/code&gt;&lt;/pre&gt;</Body>
<Tags>python,winapi,windows-8,wmi</Tags>
</question>
<answer>
<Body>&lt;blockquote&gt;  &lt;p&gt;Our anti-piracy software identifies people according to their Hard Drive Serial. This I believe is a constant feature and will not change unless the user changes their primary physical drive - correct me if I am wrong?&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;In &lt;em&gt;normal&lt;/em&gt; usage the serial number should not change, but it is &lt;em&gt;possible&lt;/em&gt; for a user to change it if they are trying to bypass your anti-piracy technique. &lt;a href=&quot;https://www.raymond.cc/blog/changing-or-spoofing-hard-disk-hardware-serial-number-and-volume-id/2/&quot; rel=&quot;nofollow&quot;&gt;See here for a list of tools that do this&lt;/a&gt;, aimed at people trying to bypass anti-cheat systems in games. So you have to consider whether the hard disk serial number is &quot;good enough&quot; to deter most people from pirating your software.&lt;/p&gt;&lt;blockquote&gt;  &lt;p&gt;What could cause such a problem? Is our code that identifies the serial not comprehensive across windows operating systems?&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;See &lt;a href=&quot;http://social.msdn.microsoft.com/Forums/vstudio/en-US/8523d7b9-0dc8-4d87-be69-a482aec9ee5e/wmi-win32physicalmedia-smart-id-in-vista-and-7-permissions?forum=netfxbcl&quot; rel=&quot;nofollow&quot;&gt;this forum thread&lt;/a&gt;. Results are varying depending on Windows version, on whether the code is run as admin or not, and whether the &lt;code&gt;Win32_PhysicalMedia&lt;/code&gt; class is used or the &lt;code&gt;Win32_DiskDrive&lt;/code&gt; class. Seems pretty unreliable, you may have to write your own abstraction layer to handle it yourself, as described in these forum posts. &lt;/p&gt;&lt;p&gt;I tried it myself and found I got two different serial numbers depending on admin vs normal and &lt;code&gt;Win32_PhysicalMedia&lt;/code&gt; vs &lt;code&gt;Win32_DiskDrive&lt;/code&gt;:&lt;/p&gt;&lt;pre&gt;&lt;code&gt;VB38bb50ab-0de50c12 &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;and &lt;/p&gt;&lt;pre&gt;&lt;code&gt;42563833626230356261302d6564303531632032&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Notice that the second string is actually a hex-encoded and byte-reversed version of the first string! Maybe the same is happening to you?&lt;/p&gt;&lt;blockquote&gt;  &lt;p&gt;is the Hard Drive Serial number the MAC address of the hardware device  or something else?&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;A MAC (Media Access Control) address only relates to network interfaces, nothing to do with hardid disks. The hard drive serial number is an arbitrary string set by the hard disk manufacturer - it can be anything and only has meaning to the manufacturer, it could even be blank if the manufacturer does not implement it.&lt;/p&gt;</Body>
</answer>
<answer>
<Body>&lt;p&gt;I know this is a bit of an old thread, but I have just had the same issue, using the drive&#x27;s serial number as a key. I thought it would be good to document my findings somewhere.&lt;/p&gt;&lt;p&gt;One thing I noticed was that somewhere between Windows 7 and Windows 8.1, there seems to have been a change in how the WMI routines return the drive serial number.&lt;/p&gt;&lt;p&gt;I have masked out some characters.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;Windows 10  reports: [S21D********04F]Windows 8.1 reports: [S21D********04F]Windows 7   reports: [2SD1********40 F]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It seems that W7 and below are not byte-swapping the drive info.&lt;/p&gt;</Body>
</answer>
</qroot>
