<?xml version="1.0" encoding="utf-8"?>
<qroot>
<question>
<Title>Use Python to remove duplicate protein sequences</Title>
<Body>&lt;p&gt;I am trying to write a script to remove duplicate amino acid sequences from a file containing seven separate Genbank entries (once working I want to apply the script to files containing &lt;code&gt;1000-5000&lt;/code&gt; entries). &lt;/p&gt;&lt;p&gt;Here is the data...&lt;/p&gt;&lt;pre&gt;&lt;code&gt;WP_013250615.1Candidatus Nitrospira defluviiSeq(&#x27;MKHVVDIELAGRRLTLETGRIAKQADGAIWATYGDTVVLATAVASQNAKPGVDF...PAG&#x27;, IUPACProtein())705WP_014960802.1Leptospirillum ferriphilumSeq(&#x27;MNPIFVEAVVGGKTVRLETGRMAKQADGSVVVWADGTVVIATAVASKVSKPGVD...SGR&#x27;, IUPACProtein())713WP_036083494.1Leptospirillum ferriphilumSeq(&#x27;MNPIFVEAVVGGKTVRLETGRMAKQADGSVVVWADGTVVIATAVASKVSKPGVD...SGR&#x27;, IUPACProtein())713WP_014449743.1Leptospirillum ferrooxidansSeq(&#x27;MNPIIVNVSVGGKNIRLETGRMAKLAGGSATVWADGTVVLATAVSAKSMKPGID...GGQ&#x27;, IUPACProtein())710WP_023525658.1Leptospirillum sp. Group II &#x27;C75&#x27;Seq(&#x27;MNPIFVEAVVGGKTVRLETGRMAKQADGSVVVWADGTVVIATAVASKVSKPGVD...SGR&#x27;, IUPACProtein())713WP_028844965.1Thermodesulfovibrio thiophilusSeq(&#x27;MEVELNIKGQNLSLQTGIIARQTDGSVLVKYGDTYVLCTVVAEKTPKEGLDFIP...TKK&#x27;, IUPACProtein())710YP_002249618.1Thermodesulfovibrio yellowstonii DSM 11347Seq(&#x27;MEVELEIKGKKLVLQTGIFAKQTNGSVLAKYGDTYVLCTVVAEKTPKEGLDFVP...TKT&#x27;, IUPACProtein())710&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;One of the entries is a duplicate (both species and sequence are identical for &lt;strong&gt;Leptospirillum ferriphilum&lt;/strong&gt;). I would like to go through the file iteratively, only keeping entries that are unique for both species name and sequence (I am expecting that the larger files will have entries with identical sequences but from different species, which I want to keep). Once the duplicates are deleted I then need will convert the Genbank file to fasta format.&lt;/p&gt;&lt;p&gt;I can extract the data by using the SeqIO.parse command, but so far have been unable to delete the duplicates (I have tried the set() command). When I check the output file I still have 7 entries instead of 6.&lt;/p&gt;&lt;p&gt;Any ideas?&lt;/p&gt;</Body>
<Tags>python,sequence,biopython</Tags>
</question>
<answer>
<Body>&lt;p&gt;This should get the job done.  It iterates through the original list, puts each line in a list, then removes duplicates with set, and finally iterates the new list with no duplicates to a new file.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;sequences = []with open(&#x27;file.txt&#x27;, &#x27;r&#x27;) as f:    for line in f:        sequences.append(line)new_list = list(set(sequences))with open(&#x27;new_file.txt&#x27;, &#x27;w&#x27;) as f:    for seq in new_list:        f.write(seq)&lt;/code&gt;&lt;/pre&gt;</Body>
</answer>
<answer>
<Body>&lt;p&gt;You&#x27;ll want to go through each entry and put them in a dictionary mapping species names to a list, like&lt;/p&gt;&lt;pre&gt;&lt;code&gt;species_dict = {}for p in proteins:    grab the species name    grab the sequence    if not species name in species_dict:        species_dict[species name] = [sequence]    else:        if not sequence in species_dict[species name]:            species_dict[species name].append(sequence)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Grab the species name by regex &lt;code&gt;&#x27;.*\d{10,10}\.\d{1,1}\s*(?P&amp;lt;sequence_name&amp;gt;\w+)&#x27;&lt;/code&gt; and the sequence by &lt;code&gt;&#x27;Seq(&#x27;(?P&amp;lt;sequence&amp;gt;\w+)&#x27;&lt;/code&gt;&lt;/p&gt;</Body>
</answer>
</qroot>
