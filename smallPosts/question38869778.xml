<?xml version="1.0" encoding="utf-8"?>
<qroot>
<question>
<Title>Pandas: set column equal to grouped sum of another column</Title>
<Body>&lt;p&gt;I have a pandas dataframe as follows:&lt;/p&gt;&lt;pre&gt;&lt;code&gt;   variable        Total_Beneficiaries  gender_text age_group0   MC_OLD_18&amp;gt;F&amp;gt;5       1534    Female  5 - 181   MC_OLD_18&amp;gt;M&amp;gt;5       1651    Male    5 - 182   MC_OLD_F&amp;gt;0&amp;lt;=1       192     Female  0 - 13   MC_OLD_F&amp;gt;18         2079    Female  18 - 604   MC_OLD_F&amp;gt;=60        171     Female  Over 605   MC_OLD_F_Child&amp;lt;5    593     Female  1 - 56   MC_OLD_M&amp;gt;0&amp;lt;=1       264     Male    0 - 17   MC_OLD_M&amp;gt;18         1892    Male    18 - 608   MC_OLD_M&amp;gt;=60        106     Male    Over 609   MC_OLD_M_Child&amp;lt;5    602     Male    1 - 5&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I want to add a column &lt;code&gt;age_group_totals&lt;/code&gt; that will be the sum of &lt;code&gt;Total_Beneficiaries&lt;/code&gt; across each &lt;code&gt;age group&lt;/code&gt;.  So for the first two rows the value would be &lt;code&gt;3185&lt;/code&gt;.  &lt;/p&gt;&lt;p&gt;So far I have been doing this by creating a new dataframe with the sums and merging back on to the original as follows:&lt;/p&gt;&lt;pre&gt;&lt;code&gt;total_by_age = izmir_agg[[&#x27;age_group&#x27;,&#x27;Total_Beneficiaries&#x27;]].groupby(&#x27;age_group&#x27;).agg({&#x27;Total_Beneficiaries&#x27;:np.sum}).reset_index().rename(columns={&#x27;Total_Beneficiaries&#x27;:&#x27;age_group_totals&#x27;})izmir_agg = izmir_agg.merge(total_by_age,how=&#x27;left&#x27;,on=&#x27;age_group&#x27;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This seems clunky and I&#x27;m wondering if there is a way to more directly add this column without creating the separate dataframe.  I tried this:&lt;/p&gt;&lt;pre&gt;&lt;code&gt;izmir_agg[&#x27;age_group_totals&#x27;] = izmir_agg.groupby(&#x27;age_group&#x27;)[&#x27;Total_Beneficiaries&#x27;].sum().tolist()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;But it doesn&#x27;t work because it returns a list of the wrong length.  Any tips for how to accomplish this in one step?&lt;/p&gt;</Body>
<Tags>python,pandas</Tags>
</question>
<answer>
<Body>&lt;p&gt;Try:&lt;/p&gt;&lt;pre&gt;&lt;code&gt;izmir_agg[&#x27;agg_totals&#x27;] = izmir_agg.groupby(&#x27;age_group&#x27;).Total_Beneficiaries.transform(&#x27;sum&#x27;)izmir_agg&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&quot;https://i.stack.imgur.com/ESbTA.png&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/ESbTA.png&quot; alt=&quot;enter image description here&quot;&gt;&lt;/a&gt;&lt;/p&gt;</Body>
</answer>
</qroot>
