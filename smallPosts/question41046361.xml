<?xml version="1.0" encoding="utf-8"?>
<qroot>
<question>
<Title>set index sort specific column pandas</Title>
<Body>&lt;p&gt;trying to prepare this data in a specific format&lt;/p&gt;&lt;pre&gt;&lt;code&gt;import pandas as pdvoting = pd.read_json(&quot;GE2000.json&quot;)voting.set_index([&#x27;county_fips&#x27;,&#x27;candidate_name&#x27;,&#x27;pty&#x27;,&#x27;vote_pct&#x27;],inplace=True)print(voting)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;this then returns&lt;/p&gt;&lt;pre&gt;&lt;code&gt;                                            votecounty_fips candidate_name  pty vote_pct2000        Howard Phillips CS  0            596            John Hagelin    NL  0            919            Harry Browne    LB  1           2636            George W. Bush  R   59        167398            Al Gore         D   28         790041001        Howard Phillips I   0              9            John Hagelin    I   0              5            Harry Browne    LB  0             51            George W. Bush  R   70         11993            Al Gore         D   29          4942&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;after this, i would like to sort vote_pct and grab the largest, like this (i&#x27;ve tried sort_values, sort_index, etc and can&#x27;t get it to yield the desired output)&lt;/p&gt;&lt;pre&gt;&lt;code&gt;                                            votecounty_fips candidate_name  pty vote_pct2000        George W. Bush  R   59        1673981001        George W. Bush  R   70         11993&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;here is the sample data&lt;/p&gt;&lt;pre&gt;&lt;code&gt;[  {    &quot;office&quot; : &quot;PRESIDENT&quot;,    &quot;county_name&quot; : &quot;Alaska&quot;,    &quot;vote_pct&quot; : &quot;0&quot;,    &quot;county_fips&quot; : &quot;2000&quot;,    &quot;pty&quot; : &quot;CS&quot;,    &quot;candidate_name&quot; : &quot;Howard Phillips&quot;,  },  {    &quot;office&quot; : &quot;PRESIDENT&quot;,    &quot;county_name&quot; : &quot;Alaska&quot;,    &quot;vote_pct&quot; : &quot;0&quot;,    &quot;county_fips&quot; : &quot;2000&quot;,    &quot;pty&quot; : &quot;NL&quot;,    &quot;candidate_name&quot; : &quot;John Hagelin&quot;,  }]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;That data continues&lt;/p&gt;</Body>
<Tags>python,pandas</Tags>
</question>
<answer>
<Body>&lt;p&gt;You can use &lt;code&gt;groupby&lt;/code&gt; for example &lt;code&gt;voting.groupby(&#x27;county_fips&#x27;)[&#x27;candidate_name&#x27;].max()&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;There is also more detailed answer here:&lt;a href=&quot;https://stackoverflow.com/questions/15705630/python-getting-the-row-which-has-the-max-value-in-groups-using-groupby&quot;&gt;Python : Getting the Row which has the max value in groups using groupby&lt;/a&gt;&lt;/p&gt;</Body>
</answer>
<answer>
<Body>&lt;p&gt;You can get the maximum for each using &lt;code&gt;groupby&lt;/code&gt; and &lt;code&gt;apply&lt;/code&gt; before doing &lt;code&gt;set_index&lt;/code&gt; and then set the index afterwards. This allows you to use &lt;code&gt;groupby&lt;/code&gt; on columns instead of on the indices (which gets weird):&lt;/p&gt;&lt;pre&gt;&lt;code&gt;voting = pd.read_json(&quot;GE2000.json&quot;)get_largest_vote_pct = lambda row: row[row.vote_pct == row.vote_pct.max()]largest = voting.groupby(&#x27;county_fips&#x27;).apply(get_largest_vote_pct)largest.set_index([&#x27;county_fips&#x27;,&#x27;candidate_name&#x27;,&#x27;pty&#x27;,&#x27;vote_pct&#x27;],inplace=True) print(largest)                                           votecounty_fips candidate_name pty vote_pct        1001        George W. Bush R   70         119932000        George W. Bush R   59        167398&lt;/code&gt;&lt;/pre&gt;</Body>
</answer>
</qroot>
