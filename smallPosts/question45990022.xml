<?xml version="1.0" encoding="utf-8"?>
<qroot>
<question>
<Title>Generate dependencies between auto-generated files</Title>
<Body>&lt;h3&gt;Description&lt;/h3&gt;&lt;p&gt;I have a code generator that takes an XML input file and outputs a c++ header and source file. These auto-generated files are then compiled with static source files to produce a library. Simplified cmake file.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;add_library(subdirectory/${MODULE_NAME} ${STATIC_SOURCES})# Invoke auto-coderadd_custom_command(    OUTPUT ${GEN_HEADER} ${GEN_SOURCE}    COMMAND ${CMAKE_COMMAND} ${CMAKE_SOURCE_DIR}/my_autocoder ${SOURCE_XML}    DEPENDS ${SOURCE_XML})# Add auto-generated source dependenciestarget_sources(${MODULE_NAME}    PUBLIC ${GEN_HEADER}    PRIVATE ${GEN_SOURCE})&lt;/code&gt;&lt;/pre&gt;&lt;h3&gt;Problem&lt;/h3&gt;&lt;p&gt;A generated header file &lt;code&gt;${GEN_HEADER_A}&lt;/code&gt; includes other generated headers files e.g. &lt;code&gt;${GEN_HEADER_B}&lt;/code&gt;. When running &lt;code&gt;make&lt;/code&gt; at the top level everything builds correctly. However when building the library in isolation, it errors because &lt;code&gt;${GEN_HEADER_B}&lt;/code&gt; does not exist.&lt;/p&gt;&lt;h3&gt;Question&lt;/h3&gt;&lt;p&gt;How do I add all dependencies like &lt;code&gt;${GEN_HEADER_A}&lt;/code&gt; on &lt;code&gt;${GEN_HEADER_B}&lt;/code&gt; without manually specifying each dependency?&lt;/p&gt;&lt;h3&gt;Attempts&lt;/h3&gt;&lt;p&gt;The &lt;code&gt;IMPLICIT_DEPENDS&lt;/code&gt; feature of &lt;code&gt;add_custom_command&lt;/code&gt; seems to have the functionality I want. However, my attempts at using it have not resulted in the code generator being invoked for &lt;code&gt;${GEN_HEADER_B}&lt;/code&gt;. My assumption is this is because I already have a rule to build &lt;code&gt;${MODULE_NAME}&lt;/code&gt; when I added the library &lt;code&gt;add_library(subdirectory/${MODULE_NAME} ${STATIC_SOURCES})&lt;/code&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;add_custom_command(    OUTPUT ${MODULE_NAME}    COMMAND ...    IMPLICIT_DEPENDS ${GEN_HEADER})&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I do see &lt;code&gt;${GEN_HEADER_B}&lt;/code&gt; in the &lt;code&gt;CXX.includecache&lt;/code&gt; under &lt;code&gt;${GEN_HEADER_A}&lt;/code&gt;&lt;/p&gt;</Body>
<Tags>c++,cmake,code-generation</Tags>
</question>
<answer>
<Body>&lt;p&gt;If you want file &lt;code&gt;A&lt;/code&gt; to be (re)created when file &lt;code&gt;B&lt;/code&gt; is built, you should specify this dependency &lt;strong&gt;explicitely&lt;/strong&gt;.&lt;/p&gt;&lt;p&gt;Dependencies discovered by &lt;em&gt;scanning&lt;/em&gt; (either automatic in &lt;code&gt;add_library&lt;/code&gt;/&lt;code&gt;add_executable&lt;/code&gt; commands, or via &lt;em&gt;IMPLICIT_DEPENDS&lt;/em&gt; option of &lt;code&gt;add_custom_command&lt;/code&gt;) are only &lt;em&gt;checked&lt;/em&gt; for modification. CMake doesn&#x27;t attempt to (re)create dependencies discovered by scanning.&lt;/p&gt;</Body>
</answer>
</qroot>
