<?xml version="1.0" encoding="utf-8"?>
<qroot>
<question>
<Title>Managed c++ code for C#</Title>
<Body>&lt;p&gt;I am trying to set my settings in Visual Studio such that I can write managed &lt;code&gt;C++&lt;/code&gt; code to be called later by a &lt;code&gt;C#&lt;/code&gt; program. I start with a new &lt;code&gt;C++&lt;/code&gt; project and here are the settings that I have changed and why:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Precompiled Headers&lt;/strong&gt; to &lt;code&gt;not using precompiled headers&lt;/code&gt;. As I just would rather not.&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Common Language Runtime Support&lt;/strong&gt; to &lt;code&gt;/clr&lt;/code&gt;. As I understand it this is fundamentally needed. &lt;/li&gt;&lt;li&gt;&lt;strong&gt;Debugging Information Format&lt;/strong&gt; from &lt;code&gt;/ZI&lt;/code&gt; to &lt;code&gt;none&lt;/code&gt;. As &lt;code&gt;/clr&lt;/code&gt; and &lt;code&gt;/ZI&lt;/code&gt; are incompatible&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Enable minimal rebuild&lt;/strong&gt; to &lt;code&gt;no&lt;/code&gt;. As &lt;code&gt;/clr&lt;/code&gt; and &lt;code&gt;/Gm&lt;/code&gt; are incompatible.&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Basic runtime checks&lt;/strong&gt; to &lt;code&gt;default&lt;/code&gt;. As &lt;code&gt;/clr&lt;/code&gt; and &lt;code&gt;/RTC1&lt;/code&gt; are incompatible.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;After all this I now come across many &lt;strong&gt;C2760&lt;/strong&gt; error codes located in &lt;code&gt;xlocale&lt;/code&gt; or &lt;code&gt;xlocnum&lt;/code&gt;. The error specifically states &lt;/p&gt;&lt;blockquote&gt;  &lt;p&gt;syntax error: unexpected token &#x27;identifier&#x27;, expected &#x27;catch&#x27;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Now, I am an extreme beginner here so maybe this is trivial and if so I apologize. My goal is to write a simple &lt;code&gt;c++ class&lt;/code&gt;, wrap it with managed code, and have a &lt;code&gt;DLL&lt;/code&gt; that I can link with a &lt;code&gt;c#&lt;/code&gt; program later.&lt;/p&gt;&lt;p&gt;When I look at the MSDN Documentation page, all they say is to compile with &lt;code&gt;/clr&lt;/code&gt; and &lt;code&gt;/LD&lt;/code&gt;. Well there is no &lt;code&gt;/LD&lt;/code&gt; option that I am able to find either, and I know that the &lt;code&gt;/LD&lt;/code&gt; option is to create the &lt;code&gt;DLL&lt;/code&gt; which is important. Any help or guidance would be greatly appreciated.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;P.S.&lt;/strong&gt; This is Visual Studio Community 2017&lt;/p&gt;</Body>
<Tags>c++,.net,visual-studio</Tags>
</question>
<answer>
<Body>&lt;p&gt;Truth is: you have to have 2 projects.&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Just old good C/C++ project. You may put a 3rd-party library here like OpenSSL or any other cross-platform source. Here you may have some challenge to remove/wrap any platform-specific code.&lt;/li&gt;&lt;li&gt;Windows Runtime Component - this is exactly CLI code that acts like bridge between native C/C++ and managed C#. You can find this at File -&gt; New project, then Visual C++ -&gt; Windows Universal. General idea about the Runtime Component is you can seamlessly import CLI methods by signature into C# code, you can call C# callbacks right at the CLI code, all C#/CLI types are binary-compatible etc. This is why you can not &quot;just add specially configured C/C++ project&quot;.&lt;/li&gt;&lt;/ol&gt;</Body>
</answer>
</qroot>
