<?xml version="1.0" encoding="utf-8"?>
<qroot>
<question>
<Title>pyodbc returns SQL Server DATE fields as strings</Title>
<Body>&lt;p&gt;I&#x27;m using pyodbc to query a SQL Server 2008 database table with columns of DATE type. &lt;/p&gt;&lt;p&gt;The resulting rows of data contain date strings rather than python datetime.date or datetime.datetime instances.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;This only appears to be an issue for columns of type DATE; columns of type DATETIME are handled correctly and return a datetime.datetime instance.&lt;/strong&gt;&lt;/p&gt;&lt;h2&gt;Example&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;import pyodbcfrom pprint import pformatdb = pyodbc.connect(&quot;DRIVER={SQL Server};SERVER=.\\SQLEXPRESS;DATABASE=scratch;Trusted_Connection=yes&quot;)print pformat(db.cursor().execute(&quot;select * from Contract&quot;).description)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Results:&lt;/p&gt;&lt;pre&gt;&lt;code&gt;((&#x27;id&#x27;, &amp;lt;type &#x27;int&#x27;&amp;gt;, None, 10, 10, 0, False), (&#x27;name&#x27;, &amp;lt;type &#x27;str&#x27;&amp;gt;, None, 23, 23, 0, False), (&#x27;some_date&#x27;, &amp;lt;type &#x27;unicode&#x27;&amp;gt;, None, 10, 10, 0, True), (&#x27;write_time&#x27;, &amp;lt;type &#x27;datetime.datetime&#x27;&amp;gt;, None, 23, 23, 3, False))&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Note that the &lt;strong&gt;some_date&lt;/strong&gt; column is indicated as type unicode string, however, in the database this column is defined as DATE:&lt;/p&gt;&lt;pre&gt;&lt;code&gt;CREATE TABLE dbo.Contract(    id INT NOT NULL,    name VARCHAR(23) NOT NULL,    some_date DATE NULL,    write_time DATETIME NOT NULL)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Is this normal, and how can I best correct it?&lt;/p&gt;</Body>
<Tags>python,sql-server,database,pyodbc</Tags>
</question>
<answer>
<Body>&lt;p&gt;Use the SQL Server native client. e.g. Put &lt;strong&gt;Driver={SQL Server Native Client 10.0}&lt;/strong&gt; in your connection string,instead of &lt;strong&gt;DRIVER={SQL Server}&lt;/strong&gt;.&lt;/p&gt;&lt;p&gt;Reproduced your scenario with date being returned as string using SQL Server ODBC driver. When using a 2008+ compatible version of the SQL Server native client, the date type is returned as expected, but it looks like datetime2 gets returned as string (in my limited testing).&lt;/p&gt;&lt;p&gt;Table definition:&lt;/p&gt;&lt;pre&gt;&lt;code&gt;create table dbo.datetest (    [date] date not null,    [datetime] datetime not null,    [datetime2] datetime2 not null);insert into    dbo.datetestvalues    (CAST(current_timestamp as DATE),     CAST(current_timestamp as datetime),     CAST(current_timestamp as datetime2));&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Example:&lt;/p&gt;&lt;pre&gt;&lt;code&gt;import pyodbcfrom pprint import pformatdb = pyodbc.connect(driver=&#x27;{SQL Server Native Client 10.0}&#x27;,                    server=&#x27;TESTSRVR&#x27;, database=&#x27;TESTDB&#x27;,                    trusted_connection=&#x27;yes&#x27;)print pformat(db.cursor().execute(&quot;select * from dbo.datetest&quot;).description)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Results:&lt;/p&gt;&lt;pre&gt;&lt;code&gt;((&#x27;date&#x27;, &amp;lt;type &#x27;datetime.date&#x27;&amp;gt;, None, 10, 10, 0, False), (&#x27;datetime&#x27;, &amp;lt;type &#x27;datetime.datetime&#x27;&amp;gt;, None, 23, 23, 3, False), (&#x27;datetime2&#x27;, &amp;lt;type &#x27;unicode&#x27;&amp;gt;, None, 27, 27, 0, False))&lt;/code&gt;&lt;/pre&gt;</Body>
</answer>
</qroot>
